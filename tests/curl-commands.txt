# SFP Portal API - cURL Test Commands Reference

API_URL="http://localhost:5000"

# ============================================================================
# 1. AUTHENTICATION ENDPOINTS
# ============================================================================

# Register a new volunteer
curl -X POST $API_URL/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "john@example.com",
    "password": "Password123",
    "first_name": "John",
    "last_name": "Doe",
    "role": "VOLUNTEER"
  }'

# Register a coordinator
curl -X POST $API_URL/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "jane@example.com",
    "password": "Password123",
    "first_name": "Jane",
    "last_name": "Smith",
    "role": "COORDINATOR"
  }'

# Register a foster
curl -X POST $API_URL/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "bob@example.com",
    "password": "Password123",
    "first_name": "Bob",
    "last_name": "Foster",
    "role": "FOSTER"
  }'

# Login
curl -X POST $API_URL/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "john@example.com",
    "password": "Password123"
  }'

# Verify token (replace TOKEN with actual JWT token)
curl -X GET $API_URL/api/auth/verify \
  -H "Authorization: Bearer TOKEN"

# ============================================================================
# 2. ANIMAL ENDPOINTS
# ============================================================================

# Get available animals (public, no auth required)
curl $API_URL/api/animals/available

# Get all animals (requires VOLUNTEER role)
curl $API_URL/api/animals \
  -H "Authorization: Bearer TOKEN"

# Create animal (requires COORDINATOR role)
curl -X POST $API_URL/api/animals \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "name": "Max",
    "species": "Dog",
    "breed": "Golden Retriever",
    "age": 3,
    "description": "Friendly and energetic dog",
    "status": "available",
    "volunteer_id": 1
  }'

# Get specific animal
curl $API_URL/api/animals/1 \
  -H "Authorization: Bearer TOKEN"

# Update animal (requires auth, RBAC enforced)
curl -X PUT $API_URL/api/animals/1 \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "description": "Updated description",
    "age": 4
  }'

# Delete animal (requires COORDINATOR role)
curl -X DELETE $API_URL/api/animals/1 \
  -H "Authorization: Bearer TOKEN"

# ============================================================================
# 3. APPLICANT ENDPOINTS
# ============================================================================

# Create applicant
curl -X POST $API_URL/api/applicants \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "email": "applicant@example.com",
    "first_name": "Sarah",
    "last_name": "Adopter",
    "phone": "555-1234",
    "address": "123 Main St",
    "status": "active"
  }'

# Get all applicants (requires COORDINATOR role)
curl $API_URL/api/applicants \
  -H "Authorization: Bearer TOKEN"

# Get specific applicant
curl $API_URL/api/applicants/1 \
  -H "Authorization: Bearer TOKEN"

# Update applicant
curl -X PUT $API_URL/api/applicants/1 \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "status": "approved"
  }'

# Delete applicant
curl -X DELETE $API_URL/api/applicants/1 \
  -H "Authorization: Bearer TOKEN"

# ============================================================================
# 4. APPLICATION ENDPOINTS
# ============================================================================

# Submit application
curl -X POST $API_URL/api/applications \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "applicant_email": "applicant@example.com",
    "animal_id": 1,
    "motivation": "I love animals and want to provide a loving home",
    "experience": "5 years of pet ownership",
    "status": "pending"
  }'

# Get all applications (requires COORDINATOR role)
curl $API_URL/api/applications \
  -H "Authorization: Bearer TOKEN"

# Get specific application
curl $API_URL/api/applications/1 \
  -H "Authorization: Bearer TOKEN"

# Update application status
curl -X PUT $API_URL/api/applications/1 \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "status": "under_review"
  }'

# Approve application (requires COORDINATOR role)
curl -X PUT $API_URL/api/applications/1/approve \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "status": "approved"
  }'

# Reject application (requires COORDINATOR role)
curl -X PUT $API_URL/api/applications/1/reject \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "reason": "Background check failed"
  }'

# Delete application
curl -X DELETE $API_URL/api/applications/1 \
  -H "Authorization: Bearer TOKEN"

# ============================================================================
# 5. INTERVIEW ENDPOINTS
# ============================================================================

# Schedule interview (requires INTERVIEWER or COORDINATOR role)
curl -X POST $API_URL/api/interviews \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "application_id": 1,
    "interviewer_id": 2,
    "scheduled_date": "2025-12-01T10:00:00Z",
    "status": "scheduled"
  }'

# Get all interviews
curl $API_URL/api/interviews \
  -H "Authorization: Bearer TOKEN"

# Get specific interview
curl $API_URL/api/interviews/1 \
  -H "Authorization: Bearer TOKEN"

# Complete interview (requires INTERVIEWER role)
curl -X PUT $API_URL/api/interviews/1/complete \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "status": "completed",
    "notes": "Applicant seems like a good fit for the animal"
  }'

# Cancel interview
curl -X PUT $API_URL/api/interviews/1/cancel \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "reason": "Reschedule needed"
  }'

# ============================================================================
# 6. CONTRACT ENDPOINTS
# ============================================================================

# Get contract for application
curl $API_URL/api/contracts/1 \
  -H "Authorization: Bearer TOKEN"

# Get all contracts
curl $API_URL/api/contracts \
  -H "Authorization: Bearer TOKEN"

# Sign contract (requires APPLICANT or COORDINATOR role)
curl -X PUT $API_URL/api/contracts/1/sign \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "signed_date": "2025-11-16T00:00:00Z"
  }'

# Cancel contract
curl -X PUT $API_URL/api/contracts/1/cancel \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "reason": "Changed decision"
  }'

# ============================================================================
# 7. VOLUNTEER ENDPOINTS
# ============================================================================

# Get all volunteers (requires COORDINATOR role)
curl $API_URL/api/volunteers \
  -H "Authorization: Bearer TOKEN"

# Get specific volunteer
curl $API_URL/api/volunteers/1 \
  -H "Authorization: Bearer TOKEN"

# Update volunteer profile
curl -X PUT $API_URL/api/volunteers/1 \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{
    "phone": "555-9876",
    "address": "456 Oak St"
  }'

# ============================================================================
# 8. SYSTEM ENDPOINTS
# ============================================================================

# Health check (no auth required)
curl $API_URL/api/health

# Get Prometheus metrics (no auth required)
curl $API_URL/metrics

# Database migration (development only)
curl -X POST $API_URL/api/migrate \
  -H "Content-Type: application/json" \
  -d '{
    "force": false
  }'

# ============================================================================
# ERROR CASES - Testing Validation & RBAC
# ============================================================================

# Invalid email format
curl -X POST $API_URL/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "invalid-email",
    "password": "Password123",
    "first_name": "Test",
    "last_name": "User",
    "role": "VOLUNTEER"
  }'

# Password too short
curl -X POST $API_URL/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "123",
    "first_name": "Test",
    "last_name": "User",
    "role": "VOLUNTEER"
  }'

# Missing required fields
curl -X POST $API_URL/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com"
  }'

# Unauthorized (invalid token)
curl $API_URL/api/animals \
  -H "Authorization: Bearer invalid-token"

# Forbidden (insufficient role)
curl -X POST $API_URL/api/animals \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer VOLUNTEER_TOKEN" \
  -d '{
    "name": "Test",
    "species": "Dog",
    "breed": "Mix",
    "age": 1,
    "description": "Test",
    "status": "available"
  }'

# ============================================================================
# USEFUL TIPS
# ============================================================================

# Save response to variable:
# TOKEN=$(curl -s -X POST $API_URL/api/auth/login ... | grep -o '"token":"[^"]*' | cut -d'"' -f4)

# Pretty print JSON (requires jq):
# curl ... | jq .

# Save response to file:
# curl ... -o response.json

# Show response headers:
# curl -i $API_URL/api/health

# Verbose output (show request/response headers):
# curl -v $API_URL/api/health

# Follow redirects:
# curl -L $API_URL/api/health

# Set custom header:
# curl -H "Custom-Header: value" $API_URL/api/health

# Send data from file:
# curl -d @data.json $API_URL/api/health
